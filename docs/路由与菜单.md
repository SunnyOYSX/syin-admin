## 登录流程

1. 用户发起登录请求

2. 获取后端返回的相关权限信息

3. 存储用户信息

4. 将权限信息提交至 **vuex/access** 存储并计算, 生成菜单与动态路由配置

5. 登录页面取生成的动态路由的第一个路由, 并进行跳转(此时路由并没有载入)

6. 在路由文件中, 监听路由加载, 并动态加载路由, **页面刷新时从此处开始执行**

	```js
	let router_configs = store.state.access.routers;
	if(!is_router_add){
		// 此处为非登录页面加载的情况, 如页面刷新的情况, 重新加载及计算菜单路由文件
		if(! store.state.access.is_calc){
			store.commit('access/reload');
		}

		// 动态加载路由
		router.addRoutes(router_configs);
		is_router_add = is_calc = true;
	}
	```
7. 加载layout组件, 于layout中调用侧边栏组件生成菜单, 并判断用户信息

8. 侧边栏读取菜单信息, 调用 menu-item 递归组件渲染出菜单


## 页面刷新

- **menu.js** 调用access方法重新加载, 重新读取本地存储的数据, 重新计算菜单与路由

	```js
	// 重载路由数据
	store.commit('access/reload');
	```

- 按上面的流程**步骤6**继续执行

## 退出登录

退出登录应清空所有之前账号所有数据以及动态添加的路由, 所以退出登录时会清除本地的所有存储并重新加载, 重新加载之后, 会通过路由文件的监控跳转回首页

## 菜单配置

菜单文件存储于 **config/menu.js**

菜单配置项

```js
{
	// 菜单项项目
	name: '系统设置',
	// 菜单显示图标, 只有第一级的菜单才会显示
	icon: '',
	// 模块 (模板文件所在文件夹)
	controller: 'system',
	// 方法 (模板文件名称)
	action: 'indexman',
	// 是否不显示在菜单栏中, 1 为不显示 (如添加修改页面需添加配置, 但是不会显示)
	is_hidden: 0,
	// 菜单配置子项
	children: [
	]
}
```